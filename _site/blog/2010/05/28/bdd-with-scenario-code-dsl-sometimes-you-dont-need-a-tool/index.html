<!DOCTYPE html>
<html lang="en-us" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <link type="text/plain" rel="author" href="site url/humans.txt" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <!-- Optimized for search engines -->
  <meta name="description" content="My previous project was distributed across cities and we had almost 30 people involved. Communication and the understanding of what needs to be done are cruc...">

  

  <link rel="canonical" href="site url/blog/2010/05/28/bdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool">

  
    <link rel="next" href="site url/blog/2010/05/30/consultancy-is-like-riding-a-running-horse" title="Consultancy is like riding a running horse">
  

  
    <link rel="prev" href="site url/blog/2010/05/26/ttdd-tautological-test-driven-development-anti-pattern" title="TTDD - Tautological Test Driven Development (Anti Pattern)">
  

  <!-- Twitter card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@username">
  <meta name="twitter:creator" content="@username">
  <meta name="twitter:title" content="BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool">
  <meta name="twitter:description" content="My previous project was distributed across cities and we had almost 30 people involved. Communication and the understanding of what needs to be done are cruc...">
  <meta name="twitter:image" content="site url/your site icon path">
  <meta name="twitter:url" content="site url/blog/2010/05/28/bdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool">

  <!-- Open graph -->
  <meta property="og:title" content="BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool">
  <meta property="og:type" content="article">
  <meta property="og:url" content="site url/blog/2010/05/28/bdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool">
  <meta property="og:image" content="site url/your site icon path">
  <meta property="og:description" content="My previous project was distributed across cities and we had almost 30 people involved. Communication and the understanding of what needs to be done are cruc...">
  <meta property="og:site_name" content="site name">
  <meta property="og:locale" content="your locale language">

  
    <meta property="article:modified_time" content="2010-05-28T13:10:30+00:00">
    <meta property="article:published_time" content="2010-05-28T13:10:30+00:00">
    <meta property="article:author" content="https://www.facebook.com/username">
    
      <meta property="og:see_also" content="site url/blog/2013/09/09/totiuorquiss">
    
      <meta property="og:see_also" content="site url/blog/2013/08/03/young-leaders-in-recife-and-us-assistant-secretary-of-state">
    
      <meta property="og:see_also" content="site url/blog/2013/02/21/follow-up-on-retrospective-actions">
    
  

  
    
    <meta property="article:section" content="technical">
    
  

  
    
    <meta property="article:tag" content="Java">
    
    <meta property="article:tag" content="Code">
    
    <meta property="article:tag" content="TDD">
    
    <meta property="article:tag" content="BDD">
    
  

  <meta property="fb:admins" content="your facebook profile id">
  <meta property="fb:app_id" content="your facebook app id">

  <title>
    
      BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool &middot; site title
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">

  

  <!-- Fonts -->
  <link href='http://fonts.googleapis.com/css?family=Source+Serif+Pro:700,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Roboto:100,300' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=PT+Sans:700' rel='stylesheet' type='text/css'>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/images/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

  <!-- modernizer -->
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

  <!--[if lt IE 9]>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
  <![endif]-->

  <!--[if (gte IE 6)&(lte IE 8)]>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/selectivizr/1.0.2/selectivizr-min.js"></script>
  <![endif]-->
</head>


  <body>
    
      <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
      <nav role="navigation" class="sidebar sidebar--right">
  <a href="/" class="textLogo textLogo--white textLogo--sidebar">site name</a>
  <ul class="sidebar-recentPosts">
    
      
      <li>
        
        <a href="/blog/2013/09/09/totiuorquiss">T&oacute;tiUorquiss</a>
        <div class="postMeta">09 Sep 2013</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2013/08/03/young-leaders-in-recife-and-us-assistant-secretary-of-state">Young Leaders in Recife and US Assistant Secretary of State</a>
        <div class="postMeta">03 Aug 2013</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2013/02/21/follow-up-on-retrospective-actions">Follow Up on Retrospective Actions </a>
        <div class="postMeta">21 Feb 2013</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2013/02/13/rss-recife-summer-school">RSS Recife Summer School</a>
        <div class="postMeta">13 Feb 2013</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2012/03/18/introducing-depth-of-test-dot">Introducing Depth of Test (DOT)</a>
        <div class="postMeta">18 Mar 2012</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2012/03/05/testing-pyramid-a-case-study">Testing Pyramid - A Case Study</a>
        <div class="postMeta">05 Mar 2012</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2012/02/04/speaking-at-qcon-beijing">Speaking at QCon Beijing</a>
        <div class="postMeta">04 Feb 2012</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2011/12/07/javascript-as-a-first-class-language">JavaScript as a First Class Language</a>
        <div class="postMeta">07 Dec 2011</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2011/11/07/my-echidna-photo-was-selected">My Echidna photo was selected</a>
        <div class="postMeta">07 Nov 2011</div>
      </li>
      
    
      
      <li>
        
        <a href="/blog/2011/10/24/thoughtworks-brazil-in-joo-pessoa">ThoughtWorks Brazil in Jo&atilde;o Pessoa</a>
        <div class="postMeta">24 Oct 2011</div>
      </li>
      
    
  </ul>
</nav>

      <nav class="menuWrapper">
  <ul class="popover popover--menu">
    <li class="menu-avatar">
      <a href="/" class="brandLogo brandLogo--small
      
      ">site name</a>
      <ul class="list list--avatarMenu hidden">
        <li class="list-item"><a href="">Twitter</a></li>
        <li class="list-item"><a href="">LinkedIn</a></li>
        <li class="list-item"><a href="">Quora</a></li>
        <li class="list-item"><a href="">Dribbble</a></li>
        <li class="list-item"><a href="">Kiva</a></li>
      </ul>
    </li>
  </ul>
</nav>

    

    <article class="postWrapper">
  <section class="section--first is-darkBackgrounded u-table">
    <div class="section-backgroundImage">

      

    </div>
    <div class="section-gradient
    
    "></div>
    <div class="section-title is-darkBackgrounded u-tableCell u-verticalAlignMiddle">
      <div class="container">
        <h2>BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool</h2>
        <div class="postMeta-wrapper">
          <ul class="postMeta">
            <li class="postMeta-datetime">
              <time datetime="2010-05-28 13:10:30 +0000">
                28 May 2010
              </time>
            </li>
            <li class="postMeta-author">
              By your name
            </li>
            <li class="postMeta-tags">
              technical
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>
  <section class="section--last">
    <div class="container container--content">
      <div class="content-body">

        <p>My previous project was distributed across cities and we had almost 30 people involved. Communication and the understanding of what needs to be done are crucial for the success of the project. </p>
<p>One of the big challenges was to make sure that the business and the technical people shared the same domain <a href="http://domaindrivendesign.org/node/132" target="_blank">Ubiquitous Language</a>. To ensure that, we started using <a href="http://jbehave.org/" target="_blank">JBehave</a> to define the acceptance criteria of the stories. Half way through, there was a big change which required many changes in the scenarios&hellip; </p>
<p><strong>Some issues that we found:</strong></p>
<ul>
<li>The scenarios are text files and extremely hard to refactor. </li>
<li>We had to change the text files (scenarios) and the Java files and keep them in sync </li>
<li>Too much duplication </li>
<li>When writing the scenarios we had no such thing as auto completion </li>
<li>When running the scenarios, we could not run 1 scenario at at time, but the whole file </li> </ul>
<p>&#160;</p>
<p align="center"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Slide 28052010 111155 AM" border="0" alt="Slide 28052010 111155 AM" src="http://fabiopereira.me/blog/wp-content/uploads/2010/05/slide28052010111155am.jpg" width="500" height="313" /> </p>
<p>The solution was to abstract our own <strong>code</strong> with a <strong>DSL layer</strong> and use it for documentation purposes. Initially we called this JMisbehave because the initial intent was to generate a read only version of the code that we could show to non-technical people and agree on acceptance criteria, as well as keep an executable documentation of the application. <strong>Code Humaniser</strong> was another suggested name&hellip; </p>
<p align="center">&#160;<img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Fullscreen capture 28052010 42326 PM" border="0" alt="Fullscreen capture 28052010 42326 PM" src="http://fabiopereira.me/blog/wp-content/uploads/2010/05/fullscreencapture2805201042326pm.jpg" width="500" height="272" />&#160; </p>
<p>Eventually we realised that the code itself was sufficient and we ended up not using the code that generated the read only version of it. Nevertheless it&rsquo;s still useful in many environments. Many times we showed the code to non-technical people and they were quite delighted to see how straight forward it was to read and to understand. Moreover, it was expressing the <strong>Language of the Business</strong>. An interesting thing is that our colleague Dan North, who wrote JBehave, came to our project one day to facilitate a retrospective and we told him the whole story. He quite liked what we had done and was quite complimentary about the fact that we had understood the concept of DDD and BDD, and the fact that it&rsquo;s not about the tools. It was actually his recommendation to use <em><strong>the_underscore_notation</strong></em> instead of <em><strong>theCamelCaseNotation</strong>, </em>we had some discussions about that, but that will be described on another post.</p>
<p></p>
<p><strong><u>Behind the Scenes - The Scenario Code DSL Implementation</u></strong></p>
<p>James Barritt saw another post of mine with some of our Scenarios Code DSL examples and suggested that I wrote a post explaining what was happening &ldquo;behind the scenes&rdquo;.&#160; Here is a high level diagram of how we separated the layers:</p>
<p align="center">&#160;<img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Fullscreen capture 28052010 43759 PM" border="0" alt="Fullscreen capture 28052010 43759 PM" src="http://fabiopereira.me/blog/wp-content/uploads/2010/05/fullscreencapture2805201043759pm.jpg" width="400" height="190" /> </p>
<p></p>
<p></p>
<p>Some code:</p>
<p><strong>Scenarios Code</strong></p>  </p>
<pre class="java" name="code">
public class Location_Scenario extends BaseScenario {<br />
  public void should_default_risk_address_when_insured_address_is_valid_for_risk() {<br />
    given(the_broker. has_started_a_home_quote());<br />
    when(the_broker. selects_a_valid_location_for_risk_address());<br />
    then(the_policy.has_home_risk_location_and_risk_address_as_same());<br />
  }<br />
}</p>
<p>public class BaseScenario {<br />
  protected Broker the_broker;<br />
  protected Policy the_policy;<br />
  (...)</p>
<p>  protected <T extends DSL> T given(T dsl) {<br />
    return dsl;<br />
  }</p>
<p>  protected <T extends DSL> T when(T dsl) {<br />
    return dsl;<br />
  }</p>
<p>  protected <T extends DSL> T then(T dsl) {<br />
    return dsl;<br />
  }</p>
<p>  protected <T extends DSL> T and(T dsl) {<br />
    return dsl;<br />
  }</p>
<p>}</pre></p>
<p><strong>DSL Code</strong></p></p>
<pre class="java" name="code">public class Broker extends DSL {<br />
  public FieldEnterer enters;<br />
  public Policy the_policy;</p>
<p>  public Broker blah() {<br />
     // call implemenation<br />
    return this;<br />
  }<br />
}</p>
<p>public class Policy extends DSL {<br />
  public FieldEnterer enters;<br />
  (...)<br />
  public Policy blah() {<br />
     // call implemenation<br />
    return this;<br />
  }<br />
}</pre></p>
<p>
This was a project with lots of people coming in and out all the time and every time someone new would join, the time taken to understand the code and relate it to the business terminology was extremely reduced by the way our tests were written.<br />
You can do the same on your project, write your tests using the language of the business.</p>


      </div>
    </div>
    <hr class="u-clearHr"/>
    <hr class="u-clearHr"/>
    <hr/>
    <div class="container container--content">
      <div class="content-body">
        <section class="section--subscribe">
  <div class="container container--content">
    <h3 class="u-alignCenter">Stay in touch</h3>
    <p>
      Hi, I'm <a href="/about/">Your Name</a>. A short description of your blog. Mickey is a minimal one-column theme for Jekyll. It's designed and developed by <a href="http://github.com/vincentchan" target="_blank">@VincentChan</a>. 
    </p>
    <div class="newsletterForm-wrapper">
      <!-- Begin MailChimp Signup Form -->
      <div id="mc_embed_signup">
        <form action="{ get this from MailChimp }" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div id="mc_embed_signup_scroll">
            <div class="mc-field-group">
              <input type="email" value="" name="EMAIL" class="textInput textInput--large" id="mce-EMAIL" placeholder="Your email address">
            </div>
            <div id="mce-responses" class="clear">
              <div class="response" id="mce-error-response" style="display:none"></div>
              <div class="response" id="mce-success-response" style="display:none"></div>
            </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
            <div style="position: absolute; left: -5000px;"><input type="text" name="{ get this from MailChimp }" tabindex="-1" value=""></div>
            <div class="clear u-alignCenter"><input type="submit" value="Get new blog posts by email" name="subscribe" id="mc-embedded-subscribe" class="button button--primary"></div>
          </div>
        </form>
      </div>
      <!--End mc_embed_signup-->
    </div>
    <hr/>
  </div>
</section>

        <div class="content-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'disqus_shortname';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

      </div>
    </div>
  </section>
  <footer class="postFooter">
    
      <section class="section--prePost is-darkBackgrounded u-table">
        <div class="section-backgroundImage section-backgroundImage--previousPage">
          <img class="post-featuredImage"
          
          style="top:0" alt="">
        </div>
        <div class="section-gradient
        
        "></div>
        <div class="section-title u-tableCell u-verticalAlignMiddle">
          <div class="container">
            <h4>Next story:</h4>
            <a class="prev" href="/blog/2010/05/26/ttdd-tautological-test-driven-development-anti-pattern">
              <h2>TTDD - Tautological Test Driven Development (Anti Pattern)</h2>
            </a>
          </div>
        </div>
      </section>
    
  </footer>
</article>

<div class="modal-toggle-group animate scaleIn">
  <div class="modal-toggle-bubbleShadow"></div>
  <div class="modal-toggle-bubble"></div>
  <div class="modal-toggle-wrapper"></div>
  <div class="modal-toggle-close-wrapper">
    <div class="modal-toggle-close"></div>
  </div>
</div>

<div class="fullscreenModal u-table">
  <div class="u-tableCell u-verticalAlignMiddle">
    <h2 class="h2--shareTitle">Share this story</h2>
    <ul class="shareWrapper">
      <li><a class="shareButton shareButton--twitter" href="https://twitter.com/intent/tweet?text=BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool by @VincentChan&url=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool" target="_blank"></a></li>
      <li><a class="shareButton shareButton--facebook" href="https://www.facebook.com/sharer/sharer.php?u=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool" target="_blank"></a></li>
      <li><a class="shareButton shareButton--linkedin" href="https://www.linkedin.com/shareArticle
?mini=true&url=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool&title=BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool"  target="_blank"></a></li>
      <li><a class="shareButton shareButton--buffer" href="https://buffer.com/add?text=BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool by @VincentChan&url=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool" target="_blank"></a></li>
      <li><a class="shareButton shareButton--hackernews" href="http://news.ycombinator.com/submitlink?u=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool&t=BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool" target="_blank"></a></li>
      <li><a class="shareButton shareButton--pocket" href="https://getpocket.com/save?url=site%20url%2Fblog%2F2010%2F05%2F28%2Fbdd-with-scenario-code-dsl-sometimes-you-dont-need-a-tool&title=BDD with Scenario Code DSL &ndash; Sometimes you don&rsquo;t need a tool" target="_blank"></a></li>
    </ul>
  </div>
</div>



    
      <label for="sidebar-checkbox" class="sidebar-toggle-wrapper">
  <div class="sidebar-toggle"></div>
</label>

    

    

    <!-- Javascript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="/assets/javascripts/imagesloaded.pkgd.min.js"></script>



<script>
  $(document).ready(function(){

    // Featured image loaded behavior
    $('.section-backgroundImage img').imagesLoaded()
      .done( function( instance ) {
        $('.post-featuredImage').addClass('is-loaded');
      });

    // Modal toggle behavior
    $('.modal-toggle-wrapper').click(function() {
    	$(this).toggleClass('active');
      $('.modal-toggle-bubble').toggleClass('active');
    	$('.modal-toggle-bubbleShadow').toggleClass('active');
      $('.modal-toggle-close-wrapper').toggleClass('active');
      $('.fullscreenModal').toggleClass('active');
    });

    // Prevent default anchor event and make a share popup
    $.fn.sharePopup = function (e, intWidth, intHeight, blnResize) {

      e.preventDefault();
      intWidth = intWidth || '750';
      intHeight = intHeight || '500';
      strResize = (blnResize ? 'yes' : 'no');

      //// Set title and open popup with focus on it
      var strTitle = ((typeof this.attr('title') !== 'undefined') ? this.attr('title') : 'Social Share'),
          strParam = 'width=' + intWidth + ',height=' + intHeight + ',resizable=' + strResize,
          objWindow = window.open(this.attr('href'), strTitle, strParam).focus();
    }

    $('.shareButton').on("click", function(e) {
      $(this).sharePopup(e);
    });
  });

  // Show modal toggle after scrolling 300px
  $(document).scroll(function() {
    $('.modal-toggle-group').toggleClass('active', $(document).scrollTop() >= 300);
  });
</script>

  </body>
</html>
